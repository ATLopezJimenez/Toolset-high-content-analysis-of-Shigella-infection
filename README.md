**TOOLSET TO ANALYSE SHIGELLA INFECTION BY HIGH CONTENT**

This repository holds ImageJ macros, python code and trained CNN models developped by Ana Teresa López Jiménez in Serge Mostowy's lab (London School of Hygiene and Tropical Medicine). They were used to identify and analyse SEPT7 recruitment to Shigella flexneri as presented in the preprint submitted for peer-review:

"High-content superresolution microscopy and deep learning assisted analysis reveals host and bacterial heterogeneity during Shigella infection". Ana T. López-Jiménez, Dominik Brokatzky, Kamla Pillay, Tyrese Williams, Gizem Özbaykal Güler and Serge Mostowy (2024)

Description of each individual item is here below:

1. **ImageJ macro: "Segmentation_bacteria_square_crop.ijm"**
     This macro segments rod shaped bacteria based on fluorescence, and then saves a square crop of the bacteria with additional channels and the segmented mask.
     This macro is to be used to generate images to train a CNN or to be classified by a trained CNN.

2. **ImageJ macro: "Easy_tool_to_classify.ijm"**
     This macro sequentially displays the cropped images containing bacteria obtained after using macro "Segmentation_bacteria_square_crop.ijm" described in (1).
     Then it asks for input from the user to sort the displayed image into different categories.
     This macro eases the process of annotation required to train a CNN. 
   
3. **ImageJ macro: "Processing_for_single_vs_clump_classification.ijm"**
     This macro generates 8-bit images (greyscale) to be classified as single or clump by the trained CNN model "model_classification_single_vs_clump.hdf5"
     This macro uses as input the square crop images generated by the ImageJ macro "Segmentation_bacteria_square_crops.ijm"

4. **Python code: "Denoise_tool.py"**
     This Python code uses image outputs from the ImageJ macro "Segmentation_bacteria_square_crop.ijm".
     It denoises the channel with of the protein of interest recruited to the bacteria using band pass filtering.
     It generates a 32 bit image with 3 channels: the channel with the bacterial fluorescence, the channel with the recruited protein (denoised), and the channel with the bacterial mask.
   
4. **ImageJ macro: "Dataset_parameters.ijm"**
     This ImageJ macro uses image outputs from the Python code "Denoise_tool.py",
     It returns dataset parameters that are required for normalisation, as required in "Normalise_tool.py"
   
5. **Python code: "Normalise_tool.py"**
     This Python code uses image outputs from the Python code "Denoise_tool.py" and requires the max value of the dataset after denoising. This max value can be obtained using the ImageJ macro "Dataset_parameters.ijm".
     It normalises the fluorescence from the channel with the recruited protein of interest.
     It generates a RGB image with to train a CNN or to be classified as SEPT7+ or SEPT7- by the trained "model_classification_SEPT7positive_vs_negative.hdf5".

6. **Trained model: "model_classification_single_vs_clump.hdf5"**
     This is a trained model to classify isolated bacteria vs. bacteria in clumps (any rod shape bacteria).
     Input images to be used have to be processed using the ImageJ macro "Processing_for_single_vs_clump_classification.ijm" described in (4).

7. **Trained model: "model_classification_SEPT7positive_vs_negative.hdf5"**
     This is a trained model to classify SETP7+ vs. SETP7- associated S. flexneri (or any alternative rod shape bacteria).
     Input images to be used have to be processed using the python code X.
     This model can be used as a pre-trained model to apply Transfer Learning to a novel CNN with different cytoskeletal components recruited to bacteria.

8. **ImageJ macro: "Bacteria_measurements.ijm"**
     This ImageJ macro measures diverse parameters on a fluorescent channel indicated by the user, within the defined bacterial mask.
     This ImageJ macro uses image outputs from the ImageJ macro "Segmentation_bacteria_square_crop.ijm"
     The output is a .cvs file containing the measurements.
   






For further questions, please contact anat.lopezjimenez@gmail.com
